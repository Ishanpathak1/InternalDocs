---
interface Props {
  title: string;
  showNav?: boolean;
  user?: { id: string; email?: string; role: string } | null;
}
const { title, showNav = true, user } = Astro.props;
---
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Source+Sans+3:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet" />
    <script is:inline>
      (function() {
        const stored = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const dark = stored === 'dark' || (!stored && prefersDark);
        if (dark) document.documentElement.classList.add('dark');
        else document.documentElement.classList.remove('dark');
      })();
    </script>
  </head>
  <body class="min-h-screen bg-[#f6f5f3] text-[#1a1a1a] transition-colors dark:bg-slate-900 dark:text-slate-100" style="font-family: 'Source Sans 3', system-ui, sans-serif;">
    {showNav && (
      <nav class="border-b border-slate-200 bg-white px-4 py-3 transition-colors dark:border-slate-700 dark:bg-slate-800">
        <div class="mx-auto flex max-w-5xl items-center justify-between px-4">
          <a href="/" class="font-semibold text-slate-800 dark:text-slate-100">Internal Docs</a>
          <div class="flex items-center gap-4">
            <button
              type="button"
              id="theme-toggle"
              aria-label="Toggle dark mode"
              class="rounded-lg p-2 text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-400 dark:hover:bg-slate-700 dark:hover:text-slate-200"
              onclick="document.documentElement.classList.toggle('dark'); localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');"
            >
              <span class="theme-icon-light hidden dark:inline" aria-hidden="true">‚òÄÔ∏è</span>
              <span class="theme-icon-dark inline dark:hidden" aria-hidden="true">üåô</span>
            </button>
            {user ? (
              <>
                <a href="/docs" class="text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-slate-100">Docs</a>
                {user.role === 'admin' && (
                  <a href="/admin" class="text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-slate-100">Admin</a>
                )}
                <form action="/api/logout" method="post" class="inline">
                  <button type="submit" class="text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-slate-100">Logout</button>
                </form>
              </>
            ) : (
              <a href="/login" class="text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-slate-100">Login</a>
            )}
          </div>
        </div>
      </nav>
    )}
    <main class="px-4 py-8 sm:py-12">
      <slot />
    </main>
  </body>
</html>
