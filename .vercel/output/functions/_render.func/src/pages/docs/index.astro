---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const entries = await getCollection('docs');
const docs = entries.sort((a, b) => {
  const aDate = a.data.pubDate?.valueOf() ?? 0;
  const bDate = b.data.pubDate?.valueOf() ?? 0;
  return bDate - aDate;
});
---
<BaseLayout title="Docs">
  <div class="mx-auto max-w-5xl">
    <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">Documentation</h1>
    <p class="mt-1 text-slate-600 dark:text-slate-400">All docs. Add or edit .md files in the repo and push to update.</p>

    <h2 class="mt-8 text-lg font-semibold text-slate-800 dark:text-slate-200">All docs</h2>
    <ul class="mt-3 space-y-2">
      {docs.map((doc) => (
        <li>
          <a
            href={`/docs/${doc.id}`}
            class="block rounded border border-slate-200 bg-white px-4 py-3 text-slate-800 hover:bg-slate-50 hover:border-slate-300 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700 dark:hover:border-slate-500"
          >
            <span class="font-medium">{doc.data.title}</span>
            {doc.data.author && <span class="ml-2 text-slate-500 dark:text-slate-400">by {doc.data.author}</span>}
            {doc.data.description && (
              <span class="ml-2 text-slate-500 dark:text-slate-400">â€” {doc.data.description}</span>
            )}
          </a>
        </li>
      ))}
    </ul>
    {docs.length === 0 && (
      <p class="mt-4 text-slate-500 dark:text-slate-400">No docs yet. Add .md files to <code class="rounded bg-slate-100 px-1.5 py-0.5 dark:bg-slate-700">src/content/docs/</code> and push to the repo.</p>
    )}
  </div>
</BaseLayout>
